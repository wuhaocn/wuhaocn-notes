---
title: 常见网络分析工具

categories:
- network

tag:
- network

---


### wireshark
一个功能强大的网络协议分析器，可以捕获和查看网络数据包，并提供丰富的过滤和分析功能。

###  tcpdump: 一个命令行工具，用于捕获网络数据包并将其打印出来，支持丰富的过滤选项。

### tshark: Wireshark 的命令行版本，可以用于对捕获的数据包进行分析和过滤。

### Netcat (nc): 一个网络工具，用于创建 TCP/IP 连接、监听端口、发送和接收数据等操作，常用于调试和测试网络应用程序。

### nmap: 一个网络扫描工具，用于发现网络上的主机和开放的端口，并提供详细的网络信息。

### ngrep: 一个类似于 grep 的工具，用于在捕获的数据包中搜索指定的模式或字符串。

### ss: 一个用于查看套接字统计信息的命令行工具，可以显示当前系统中的网络连接、监听端口等信息。

### iftop: 一个实时的网络带宽监视工具，可以显示当前网络流量的情况，并按流量大小进行排序。

### tcptrack: 一个实时的 TCP 连接跟踪工具，可以显示当前系统上的 TCP 连接情况，并提供类似于 top 命令的界面。

### nload: 一个简单的命令行工具，用于显示当前系统的网络流量情况，可以按接口或总和显示。

## 工具包
bpf ebpf pcap libpcap


af_packet pcap bpf ebpf

### af_packet

af_packet是Linux内核提供的一种套接字类型，用于实现高性能的数据包捕获。它允许用户空间程序直接访问数据包，而无需经过内核和用户空间之间的复制。因此，它通常被用于实现网络嗅探器和数据包分析工具。

### pcap

Pcap是一种数据包捕获文件格式的简称，它也是一组用于在Unix和类Unix系统上捕获数据包的库和工具的名称。这些工具和库使开发人员能够编写网络分析工具，用于捕获、分析和处理网络数据包。Pcap库是一种用于捕获网络数据包的通用接口，它可以在不同的平台上实现，例如libpcap在Unix-like系统上，WinPcap在Windows系统上。

### BPF 

BPF(Berkeley Packet Filter)：BPF是一种网络过滤器，它允许用户指定一组规则来选择需要捕获或处理的数据包。最初，BPF是在Unix系统中实现的，但现在它已经成为网络数据包过滤的标准技术，可以在多种系统上使用。BPF提供了一种灵活的机制，可以根据不同的条件过滤数据包，例如源或目标IP地址、端口号、协议类型等。

### eBPF
eBPF (extended Berkeley Packet Filter)：eBPF是BPF的扩展，它引入了一种更加灵活和功能强大的虚拟机，可以在内核中执行用户定义的代码。eBPF允许在数据包处理过程中执行复杂的逻辑，从而可以实现更高级的功能，例如动态网络过滤、性能监控、安全策略等。与传统的BPF相比，eBPF具有更强的安全性和灵活性，并且可以在运行时加载和卸载代码，而无需重新编译内核。

### Scapy

Scapy是一个强大的交互式数据包处理工具和库，它允许用户创建、发送、捕获和分析网络数据包。Scapy提供了一个灵活的Python接口，可以用于编写自定义的网络应用程序和工具。

### dpdk
DPDK（Data Plane Development Kit）是一个用于高性能数据包处理的开源工具集，它提供了一组库和驱动程序，用于加速数据包的处理和转发。
DPDK可以在通用服务器上实现高性能的网络功能，例如包转发、防火墙、负载均衡等。


因此，这些术语涉及到网络数据包捕获和处理的不同方面，从基本的数据包访问（af_packet），到数据包捕获工具和库（pcap），再到过滤器（BPF）和其扩展（eBPF），每个都提供了不同级别和功能的抽象。

常见可用软件包
tcpdump wireshark nmap packetbeat

nmap
Nmap是一个流行的网络扫描工具，它能够发现网络上的主机和服务，并提供详细的信息，例如开放的端口、操作系统类型等。Nmap还支持对目标系统进行漏洞扫描和安全评估。

tcpdump
Tcpdump是一个用于在Unix和类Unix系统上进行网络数据包捕获和分析的命令行工具。
它能够以特定的过滤条件捕获网络接口上的数据包，并将其以人类可读的格式输出到终端或保存到文件中供后续分析。
Tcpdump支持广泛的协议，包括TCP、UDP、ICMP等，用户可以通过BPF（Berkeley Packet Filter）语法来定义捕获过滤器，以过滤出符合特定条件的数据包。
Tcpdump是网络管理员和安全分析师的常用工具，用于诊断网络问题、监视网络流量、分析网络攻击等。
它提供了丰富的选项和功能，如选择特定网络接口、设置捕获过滤器、指定捕获时间等，使用户能够灵活地进行网络数据包的捕获和分析。

Wireshark：
Wireshark是一个流行的网络数据包分析工具，它能够捕获、分析和显示网络数据包的内容。
Wireshark提供了一个直观的图形界面，使用户能够轻松地查看和分析数据包，同时支持多种协议和过滤器。

Packetbeat
Packetbeat是一款开源的网络数据包分析工具，由Elastic公司开发。它设计用于监控应用程序、服务和系统之间的通信，以及捕获和分析网络流量。
Packetbeat能够实时捕获数据包，并解析其中的各种协议，如HTTP、DNS、MySQL等，然后将解析后的数据发送到Elasticsearch进行索引和分析。
通过与Elasticsearch、Logstash和Kibana等Elastic Stack中的其他组件集成，
Packetbeat可以实现网络流量的实时监控、故障诊断、性能优化等功能。它特别适用于分布式系统和微服务架构下的网络流量分析和监控。

文件格式：
pcap
这个是 libpcap 的格式，也是 tcpdump 和 Wireshark 等工具默认支持的文件格式。pcap 格式的文件中除了报文数据以外，
也包含了抓包文件的元信息，比如版本号、抓包时间、每个报文被抓取的最大长度，等等。

cap
cap 文件可能含有一些 libpcap 标准之外的数据格式，它是由一些 tcpdump 以外的抓包程序生成的。比如 Citrix 公司的 netscaler 负载均衡器，
它的 nstrace 命令生成的抓包文件，就是以.cap 为扩展名的。这种文件除了包含 pcap 标准定义的信息以外，
还包含了 LB 的前端连接和后端连接之间的 mapping 信息。Wireshark 是可以读取这些.cap 文件的，只要在正确的版本上。

pcapng
pcap 格式虽然满足了大部分需求，但是它也有一些不足。比如，现在多网口的情况已经越来越常见了，我们也经常需要从多个网络接口去抓取报文，
那么在抓包文件里，如果不把这些报文跟所属的网口信息展示清楚，那我们的分析，岂不是要张冠李戴了吗？
为了弥补 pcap 格式的不足，人们需要有一种新的文件格式，pcapng 就出现了。有了它，单个抓包文件就可以包含多个网络接口上，抓取到的报文了。
